[('udhcp-0.9.8.orig/packet.c',
  'udhcp-0.9.8/packet.c',
  '--- udhcp-0.9.8.orig/packet.c\n+++ udhcp-0.9.8/packet.c\n@@ -26,6 +26,7 @@\nswitch (type) {\ncase DHCPDISCOVER:\ncase DHCPREQUEST:\n+\tcase DHCPDECLINE:\ncase DHCPRELEASE:\ncase DHCPINFORM:\npacket->op = BOOTREQUEST;\n@@ -146,18 +147,18 @@\npacket.ip.daddr = dest_ip;\npacket.udp.source = htons(source_port);\npacket.udp.dest = htons(dest_port);\n-\tpacket.udp.len = htons(sizeof(packet.udp) + sizeof(struct dhcpMessage)); /* cheat on the psuedo-header */\n+\tpacket.udp.len = htons(sizeof(packet.udp) + OUT_MESSAGE_LENGTH); /* cheat on the psuedo-header */\npacket.ip.tot_len = packet.udp.len;\n-\tmemcpy(&(packet.data), payload, sizeof(struct dhcpMessage));\n-\tpacket.udp.check = checksum(&packet, sizeof(struct udp_dhcp_packet));\n+\tmemcpy(&(packet.data), payload, OUT_MESSAGE_LENGTH);\n+\tpacket.udp.check = checksum(&packet, OUT_UDP_LENGTH);\n\n-\tpacket.ip.tot_len = htons(sizeof(struct udp_dhcp_packet));\n+\tpacket.ip.tot_len = htons(OUT_UDP_LENGTH);\npacket.ip.ihl = sizeof(packet.ip) >> 2;\npacket.ip.version = IPVERSION;\npacket.ip.ttl = IPDEFTTL;\npacket.ip.check = checksum(&(packet.ip), sizeof(packet.ip));\n\n-\tresult = sendto(fd, &packet, sizeof(struct udp_dhcp_packet), 0, (struct sockaddr *) &dest, sizeof(dest));\n+\tresult = sendto(fd, &packet, OUT_UDP_LENGTH, 0, (struct sockaddr *) &dest, sizeof(dest));\nif (result <= 0) {\nDEBUG(LOG_ERR, "write on socket failed: %s", strerror(errno));\n}\n@@ -196,7 +197,7 @@\nif (connect(fd, (struct sockaddr *)&client, sizeof(struct sockaddr)) == -1)\nreturn -1;\n\n-\tresult = write(fd, payload, sizeof(struct dhcpMessage));\n+\tresult = write(fd, payload, OUT_MESSAGE_LENGTH);\nclose(fd);\nreturn result;\n}')]