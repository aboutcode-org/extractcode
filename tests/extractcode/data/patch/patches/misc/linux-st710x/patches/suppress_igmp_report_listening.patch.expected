[('linux-2.6.23/net/ipv4/igmp.c.orig',
  'linux-2.6.23/net/ipv4/igmp.c',
  '--- linux-2.6.23/net/ipv4/igmp.c.orig\n+++ linux-2.6.23/net/ipv4/igmp.c\n@@ -922,6 +922,8 @@\nread_unlock(&in_dev->mc_list_lock);\n}\n\n+static char supress_report_listening = 0;\n+\nint igmp_rcv(struct sk_buff *skb)\n{\n/* This basically follows the spec line by line -- see RFC1112 */\n@@ -960,9 +962,11 @@\nif (((struct rtable*)skb->dst)->fl.iif == 0)\nbreak;\n/* don\'t rely on MC router hearing unicast reports */\n-\t\tif (skb->pkt_type == PACKET_MULTICAST ||\n-\t\t    skb->pkt_type == PACKET_BROADCAST)\n-\t\t\tigmp_heard_report(in_dev, ih->group);\n+                if (!supress_report_listening) {\n+                  if (skb->pkt_type == PACKET_MULTICAST ||\n+                      skb->pkt_type == PACKET_BROADCAST)\n+                    igmp_heard_report(in_dev, ih->group);\n+                }\nbreak;\ncase IGMP_PIM:\n#ifdef CONFIG_IP_PIMSM_V1\n@@ -2611,10 +2615,45 @@\n.release\t=\tseq_release_private,\n};\n\n+static int proc_read_supress_report_listening(char *page, char **start,\n+\t\t\t    off_t off, int count,\n+\t\t\t    int *eof, void *data) {\n+  int len;\n+  char *supress_report_listening = (char*)data;\n+\n+  len = sprintf(page, "%d\\n", *supress_report_listening);\n+\n+  return len;\n+}\n+\n+static int proc_write_supress_report_listening(struct file *file,\n+\t\t\t     const char *buffer,\n+\t\t\t     unsigned long count,\n+\t\t\t     void *data)\n+{\n+\tchar *supress_report_listening = (char*)data;\n+\n+\tif(count == 0 || copy_from_user(supress_report_listening, buffer, 1))\n+          return -EFAULT;\n+\n+       *supress_report_listening = *supress_report_listening == \'0\' ? 0 : 1;\n+\n+\treturn count;\n+}\n+\n+\nint __init igmp_mc_proc_init(void)\n{\n+\n+  struct proc_dir_entry *supress_report_listening_proc;\nproc_net_fops_create("igmp", S_IRUGO, &igmp_mc_seq_fops);\nproc_net_fops_create("mcfilter", S_IRUGO, &igmp_mcf_seq_fops);\n+\tsupress_report_listening_proc = create_proc_entry("igmp_supress_report_listening", S_IWUGO, NULL);\n+\n+        supress_report_listening_proc->owner = THIS_MODULE;\n+        supress_report_listening_proc->data = &supress_report_listening;\n+        supress_report_listening_proc->read_proc = proc_read_supress_report_listening;\n+        supress_report_listening_proc->write_proc = proc_write_supress_report_listening;\nreturn 0;\n}\n#endif')]