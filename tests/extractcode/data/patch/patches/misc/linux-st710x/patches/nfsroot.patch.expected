[('linux-2.6.23/fs/nfs/nfsroot.c.orig',
  'linux-2.6.23/fs/nfs/nfsroot.c',
  '--- linux-2.6.23/fs/nfs/nfsroot.c.orig\n+++ linux-2.6.23/fs/nfs/nfsroot.c\n@@ -86,9 +86,11 @@\n#include <linux/root_dev.h>\n#include <net/ipconfig.h>\n#include <linux/parser.h>\n+#include <linux/delay.h>\n\n/* Define this to allow debugging output */\n-#undef NFSROOT_DEBUG\n+//#undef NFSROOT_DEBUG\n+#define NFSROOT_DEBUG\n#define NFSDBG_FACILITY NFSDBG_ROOT\n\n/* Default path we try to mount. "%s" gets replaced by our IP address */\n@@ -459,6 +461,30 @@\nproto = (nfs_data.flags & NFS_MOUNT_TCP) ? IPPROTO_TCP : IPPROTO_UDP;\n\nif (nfs_port < 0) {\n+\t\tport = -1;\n+\t\twhile (port < 0) {\n+\t\t\tport = root_nfs_getport(NFS_PROGRAM, nfsd_ver, proto);\n+\t\t\tif (port < 0) {\n+\t\t\t\tprintk(KERN_ERR "Root-NFS: Unable to get nfsd port number from server, trying again...\\n");\n+\t\t\t\tmsleep(1000);\n+\t\t\t}\n+\t\t}\n+\t\tprintk(KERN_DEBUG "Root-NFS: Portmapper on server returned %d as nfsd port\\n", port);\n+\t\tnfs_port = port;\n+\t}\n+\tport = -1;\n+\twhile (port < 0) {\n+\t\tport = root_nfs_getport(NFS_MNT_PROGRAM, mountd_ver, proto);\n+\t\tif (port < 0) {\n+\t\t\tprintk(KERN_ERR "Root-NFS: Unable to get mountd port number from server, trying again...\\n");\n+\t\t\tmsleep(1000);\n+\t\t}\n+\t}\n+\tmount_port = port;\n+\tprintk(KERN_DEBUG "Root-NFS: mountd port is %d\\n", port);\n+\treturn 0;\n+\n+\tif (nfs_port < 0) {\nif ((port = root_nfs_getport(NFS_PROGRAM, nfsd_ver, proto)) < 0) {\nprintk(KERN_ERR "Root-NFS: Unable to get nfsd port "\n"number from server, using default\\n");'),
 ('linux-2.6.23/init/do_mounts.c.orig',
  'linux-2.6.23/init/do_mounts.c',
  '--- linux-2.6.23/init/do_mounts.c.orig\n+++ linux-2.6.23/init/do_mounts.c\n@@ -394,6 +394,9 @@\n{\n#ifdef CONFIG_ROOT_NFS\nif (MAJOR(ROOT_DEV) == UNNAMED_MAJOR) {\n+\t\twhile(!mount_nfs_root())\n+\t\t\tmsleep(1000);\n+\t\treturn;\nif (mount_nfs_root())\nreturn;\n')]