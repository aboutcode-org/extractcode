[('linux-2.6.23/arch/sh/boards/st/mb442/mach.c.org',
  'linux-2.6.23/arch/sh/boards/st/mb442/mach.c',
  '--- linux-2.6.23/arch/sh/boards/st/mb442/mach.c.org\n+++ linux-2.6.23/arch/sh/boards/st/mb442/mach.c\n@@ -17,6 +17,9 @@\n#include <asm/machvec.h>\n#include <asm/irq-stb7100.h>\n\n+#define SYSCONF_BASE (0x19001000)\n+#define SYSCONF_DEVICEID (SYSCONF_BASE + 0x000)\n+\nstatic void __iomem *mb442_ioport_map(unsigned long port, unsigned int size)\n{\n#ifdef CONFIG_BLK_DEV_ST40IDE\n@@ -37,16 +40,45 @@\n\nstatic void __init mb442_init_irq(void)\n{\n+#ifdef CONFIG_SH_MOTOROLA_VIP19XX\n+ \tunsigned long sysconf;\n+ \tunsigned long chip_7109;\n+\tunsigned int *addr = ioremap_nocache(SYSCONF_BASE, 0x100);\n+\n+\tsysconf = readl(addr);\n+\tchip_7109 = (((sysconf >> 12) & 0x3ff) == 0x02c);\n+\tiounmap(addr);\n+#endif\n/* enable individual interrupt mode for externals */\nplat_irq_setup_pins(IRQ_MODE_IRQ);\n\n/* Set the ILC to route external interrupts to the the INTC */\n/* Outputs 0-3 are the interrupt pins, 4-7 are routed to the INTC */\n-\t/* Inputs sys-irq2 and 3 are unused (pulled high) */\n+\t/* Inputs sys-irq2 and 3 are unused (pulled low) */\n+#ifndef CONFIG_SH_MOTOROLA_VIP19XX\nilc_route_external(ILC_EXT_IRQ0, 4, 0);\t\t/* SMC Ethernet */\nilc_route_external(ILC_EXT_IRQ1, 5, 0);\t\t/* ATA */\nilc_route_external(ILC_EXT_IRQ2, 6, 0);\t\t/* Unused */\nilc_route_external(ILC_EXT_MDINT, 7, 0);\t/* STe100 PHY */\n+#else\n+\t/* Motorola boards:\n+\t     ILC_EXT_IRQ0: ETH_IRQ~ (VIP1900 only)\n+\t     ILC_EXT_IRQ1: NIM_IRQ~ (VIP1900 and VIP1900-9)\n+\t     ILC_EXT_IRQ2: Not used\n+\t     ILC_EXT_IRQ3: Not used\n+\t     ILC_EXT_IRB_WAKEUP: Not used but connected to IR data\n+\t     ILC_EXT_NMI: Not used\n+\t     ILC_EXT_MDINT: MDINT~ (VIP1900-9 only)\n+\t     ILC_EXT_LOWPOWEROUT: Not used\n+\t*/\n+\tilc_route_external(ILC_EXT_IRQ1, 5, 1);\n+\tif (chip_7109) {\n+\t\tilc_route_external(ILC_EXT_MDINT, 4, 1);\n+\t}\n+\telse {\n+\t\tilc_route_external(ILC_EXT_IRQ0, 4, 1);\n+\t}\n+#endif\n}\n\nvoid __init mb442_setup(char**);')]