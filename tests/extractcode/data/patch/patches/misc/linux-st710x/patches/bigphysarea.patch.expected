[('linux-2.6.23/mm/bpa2.c.org',
  'linux-2.6.23/mm/bpa2.c',
  '--- linux-2.6.23/mm/bpa2.c.org\n+++ linux-2.6.23/mm/bpa2.c\n@@ -344,25 +344,6 @@\n}\n\n/*\n- * Create legacy "bigphysarea" partition (if kindly asked ;-)\n- */\n-static int __init bpa2_bigphys_setup(char *str)\n-{\n-\tconst char *name = "bigphysarea";\n-\tint pages;\n-\n-\tif (get_option(&str, &pages) != 1) {\n-\t\tprintk(KERN_ERR "bpa2: wrong \'bigphysarea\' parameter\\n");\n-\t\treturn -EINVAL;\n-\t}\n-\n-\tbpa2_add_part(&name, 1, 0, pages << PAGE_SHIFT, BPA2_NORMAL);\n-\n-\treturn 1;\n-}\n-__setup("bigphysarea=", bpa2_bigphys_setup);\n-\n-/*\n* Create "bpa2parts"-defined partitions\n*/\nstatic int __init bpa2_parts_setup(char *str)'),
 ('linux-2.6.23/init/main.c.org',
  'linux-2.6.23/init/main.c',
  '--- linux-2.6.23/init/main.c.org\n+++ linux-2.6.23/init/main.c\n@@ -56,6 +56,9 @@\n#include <linux/device.h>\n#include <linux/kthread.h>\n#include <linux/immediate.h>\n+#ifdef CONFIG_BPA2\n+#include <linux/bpa2.h>\n+#endif\n\n#include <asm/io.h>\n#include <asm/bugs.h>\n@@ -511,6 +512,40 @@\n{\n}\n\n+unsigned long dvr_bigphysarea_addition __attribute__ ((section (".dvr_bigphysarea_addition"))) = 0;\n+unsigned long dvb_bigphysarea_addition __attribute__ ((section (".dvb_bigphysarea_addition"))) = 0;\n+unsigned long testapp_bigphysarea_addition __attribute__ ((section (".testapp_bigphysarea_addition"))) = 0;\n+\n+#ifdef CONFIG_BPA2\n+static void __init init_bigphysarea(void)\n+{\n+\tstruct bpa2_partition_desc partdesc = {\n+\t\t.name   = "bigphysarea",\n+\t\t.start  = 0,\n+\t\t.size   = 0,\n+\t\t.flags  = BPA2_NORMAL,\n+\t\t.aka    = NULL,\n+\t};\n+\n+\tif (dvr_bigphysarea_addition) {\n+\t\tprintk(KERN_NOTICE "Kernel has DVR version 5 support\\n");\n+\t} else {\n+\t\tprintk(KERN_NOTICE "Kernel has NOT DVR version 5\\n");\n+\t}\n+       if (dvb_bigphysarea_addition) {\n+               printk(KERN_NOTICE "Kernel has DVB support\\n");\n+       } else {\n+               printk(KERN_NOTICE "Kernel has NOT DVB support\\n");\n+       }\n+\tpartdesc.size = (CONFIG_VIP19XX_BIGPHYSAREA_SIZE\n+\t\t\t + dvr_bigphysarea_addition\n+\t\t\t + dvb_bigphysarea_addition\n+\t\t\t + testapp_bigphysarea_addition) << PAGE_SHIFT;\n+\n+\tbpa2_init(&partdesc, 1);\n+}\n+#endif\n+\nasmlinkage void __init start_kernel(void)\n{\nchar * command_line;\n@@ -564,6 +589,9 @@\nparse_args("Booting kernel", static_command_line, __start___param,\n__stop___param - __start___param,\n&unknown_bootoption);\n+#ifdef CONFIG_BPA2\n+\tinit_bigphysarea();\n+#endif\nif (!irqs_disabled()) {\nprintk(KERN_WARNING "start_kernel(): bug: interrupts were "\n"enabled *very* early, fixing it\\n");')]